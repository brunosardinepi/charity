{% extends '_layout.html' %}
{% load static from staticfiles %}
{% load donation_extras %}
{% load page_extras %}

{% block title %} Home | {{ block.super }}{% endblock %}

{% block head_extra %}
<script type="text/javascript">
if (window.location.hash == '#_=_' || window.location.hash == '#'){
    if (history.replaceState) {
        var cleanHref = window.location.href.split('#')[0];
        history.replaceState(null, null, cleanHref);
    } else {
        window.location.hash = '';
    }
}
</script>
{% endblock %}

{% block body_content %}
    {% if sponsored %}
        <h2>Sponsored Pages</h2>
        <ul>
            {% for page in sponsored %}
                <li><a href="{% url 'page' page_slug=page.page_slug %}">{{ page.name }}</a></li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if trending_pages %}
        <h2>Trending Pages</h2>
        <ul>
            {% for page in trending_pages %}
                <li><a href="{% url 'page' page_slug=page.page_slug %}">{{ page.name }}</a></li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if trending_campaigns %}
        <h2>Trending Campaigns</h2>
        <ul>
            {% for campaign in trending_campaigns %}
                <li><a href="{% url 'campaign' page_slug=campaign.page.page_slug campaign_pk=campaign.pk campaign_slug=campaign.campaign_slug %}">{{ campaign.name }}</a></li>
            {% endfor %}
        </ul>
    {% endif %}

    <h2>Total raised: {{ donations|cents_to_dollars }}</h2>
    <p><a href="{% url 'page_create' %}">Create Page</a></p>
    <p><a href="">Create Campaign</a></p>

    {% if user.is_authenticated %}
        <p><a href="{% url 'invite' %}">Invite</a></p>
    {% else %}
        <p><a href="{% url 'forgot_password_request' %}">Forgot password?</a></p>
    {% endif %}

    <form action="{% url 'search:search' %}" method="POST">
        {% csrf_token %}
        <input id="q" name="q" type="text" />
        <input type="submit" value="Search" />
    </form>
{% endblock %}
